from app import db
import datetime
import enum


class MalwareData(db.Model):

    id           = db.Column(db.Integer, primary_key = True, unique = True, autoincrement = True, nullable = False)
    domain       = db.Column(db.String(100), index= True, nullable = False)
    port         = db.Column(db.Integer, default = 80, index = True, nullable = False)
    query_string = db.Column(db.String(1000), default = '', index = True, nullable = True)
    category     = db.Column(db.String(100), default = 'malware', index = True, nullable = False)
    is_malicious = db.Column(db.Enum("true", "false"), name="is_malicious", index = True, default = "false", nullable = False)
    created_on   = db.Column(db.DateTime, default = datetime.datetime.now(), nullable = False)
    updated_on   = db.Column(db.DateTime, default = datetime.datetime.now(), nullable = True)

    def __init__(self, domain, port, query_string, is_malicious):
        self.domain = name
        self.port = port
        self.query_string = query_string
        self.is_malicious = is_malicious
